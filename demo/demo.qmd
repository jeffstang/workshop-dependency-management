---
title: "Demo (Quarto): renv + conda with native Python chunks"
format: html
---

# Overview

This Quarto demo shows:
1. **renv** for R package management
2. **Native Python chunks** (no reticulate needed for execution)
3. **Reticulate** for R-to-Python interoperability

## R / renv section

```{r}
# Initialize renv for the project (run once)
if (!requireNamespace("renv", quietly = TRUE)) install.packages("renv")
# renv::init()  # uncomment to initialize in a live session

# Example R code (will run if packages are available)
library(ggplot2)
library(dplyr)

# small example dataset
x_vals <- rnorm(100)
df <- data.frame(x = x_vals, y = rnorm(100) + x_vals)

p <- ggplot(df, aes(x = x, y = y)) + geom_point() + geom_smooth(method = "lm")
print(p)

# After installing packages, run renv::snapshot() to record versions
# renv::snapshot()
```

---

## Python section (Native Quarto Python engine)

**Note:** Before rendering, activate your conda environment:
```bash
conda activate workshop-dependency
```

Quarto will automatically use Jupyter to execute Python chunks:

```{python}
# Example Python snippet (requires the conda env from environment.yml)
import pandas as pd
import matplotlib.pyplot as plt

pdf = pd.DataFrame({"x": [1,2,3,4], "y": [2,3,5,7]})
print(pdf.head())

plt.plot(pdf['x'], pdf['y'], marker='o')
plt.title('Simple Python plot from native Quarto chunk')
plt.show()
```

---

## Reticulate: R â†” Python interoperability

Use reticulate when you need to share objects between R and Python:

```{r}
library(reticulate)
# Point to the conda env (adjust name if you changed it)
use_condaenv("workshop-dependency", required = TRUE)

# Show Python configuration
print(py_config())

# Import pandas and create a DataFrame from R
pd <- import("pandas")
py_df <- pd$DataFrame(list(a = c(1,2,3), b = c(4,5,6)))
print(py_df)

# Convert to R data.frame
r_df <- py_to_r(py_df)
print(class(r_df))
print(r_df)
```

---

## Notes for attendees

- **Quarto automatically detects chunk types** and uses the appropriate engine
- Python chunks run via Jupyter (no reticulate needed for execution)
- R chunks run via knitr
- Use reticulate only when you need to share data between R and Python
- Before rendering: `conda activate workshop-dependency && quarto render demo.qmd`
